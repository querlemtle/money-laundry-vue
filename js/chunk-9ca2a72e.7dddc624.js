(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9ca2a72e"],{"1f9e":function(e,t,a){"use strict";a("3bbf")},"246a":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",[t("AdminHeader"),t("div",{staticClass:"wrap"},[t("h4",{staticClass:"title text-center py-3"},[e._v("新增選項")]),t("OptionForm",{attrs:{"initial-categories":e.categories}})],1)],1)},i=[],o=a("5407"),r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"wrap"},[t("form",{staticClass:"d-flex flex-column"},[t("div",{staticClass:"categoryId"},[t("label",{attrs:{for:"categoryId"}},[e._v("關卡類別")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.toadd.categoryId,expression:"toadd.categoryId"}],attrs:{name:"categoryId"},on:{blur:e.handleCategoryChange,change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.toadd,"categoryId",t.target.multiple?a:a[0])}}},[t("option",{attrs:{value:"",selected:"",disabled:""}},[e._v("請選擇關卡類別")]),e._l(e.initialCategories,(function(a){return t("option",{key:a.id,domProps:{value:a.id}},[e._v(" "+e._s(a.type)+" ")])}))],2)]),t("div",{staticClass:"description"},[t("label",{attrs:{for:"name"}},[e._v("選項描述")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.toadd.name,expression:"toadd.name"}],attrs:{type:"text",name:"name"},domProps:{value:e.toadd.name},on:{input:function(t){t.target.composing||e.$set(e.toadd,"name",t.target.value)}}})]),t("div",{staticClass:"level"},[t("label",{attrs:{for:"levelId"}},[e._v("屬於哪個關卡？")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.toadd.levelId,expression:"toadd.levelId"}],attrs:{name:"levelId"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.toadd,"levelId",t.target.multiple?a:a[0])}}},[e.isSuggestLevelsExist?e._e():t("option",{attrs:{value:"",selected:"",disabled:""}},[e._v(" 請先選擇關卡類別 ")]),e._l(e.suggestLevels,(function(a){return t("option",{key:a.id,domProps:{value:a.id}},[e._v(" "+e._s(a.level)+" ")])}))],2),e.isLevelLoading?t("div",{staticClass:"spinner-border text-primary",attrs:{role:"status"}},[t("span",{staticClass:"visually-hidden"},[e._v("Loading...")])]):e._e()]),t("div",{staticClass:"isLegal"},[t("span",{attrs:{for:"isLegal"}},[e._v("是否合法？")]),t("div",{staticClass:"radio-container"},e._l(e.legalOptions,(function(a){return t("span",{key:a.value,staticClass:"radio-option"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.toadd.isLegal,expression:"toadd.isLegal"}],attrs:{type:"radio",name:"legal"},domProps:{value:a.checked,checked:e._q(e.toadd.isLegal,a.checked)},on:{change:function(t){return e.$set(e.toadd,"isLegal",a.checked)}}}),t("label",{attrs:{for:"legal"}},[e._v(e._s(a.name))])])})),0)]),t("div",{staticClass:"error-context"},[t("label",{attrs:{for:"description"}},[e._v("錯誤事件敘述")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.toadd.description,expression:"toadd.description"}],attrs:{name:"description"},domProps:{value:e.toadd.description},on:{input:function(t){t.target.composing||e.$set(e.toadd,"description",t.target.value)}}})]),t("div",{staticClass:"law"},[t("label",{attrs:{for:"law"}},[e._v("法律條文")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.toadd.law,expression:"toadd.law"}],attrs:{name:"law"},domProps:{value:e.toadd.law},on:{input:function(t){t.target.composing||e.$set(e.toadd,"law",t.target.value)}}})]),t("div",{staticClass:"w-100 button-container d-flex justify-content-end"},[t("button",{staticClass:"return-btn px-4 py-2 my-2",attrs:{disabled:e.isProcessing},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.$router.push(e.subHeaderRouterrouter)}}},[e._v(" 返回列表 ")]),t("button",{staticClass:"save-btn px-4 py-2 my-2",attrs:{type:"submit",disabled:e.isProcessing},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.handleFormSave(e.toadd)}}},[e._v(" 儲存草稿 ")]),t("button",{staticClass:"send-btn px-4 py-2 my-2",attrs:{type:"submit",disabled:e.isProcessing},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.handleFormSubmit(e.toadd)}}},[e._v(" 發佈 ")])])])])},n=[],l=(a("d9e2"),a("678d")),d=a("2fa3"),c={name:"OptionForm",props:{initialCategories:{type:Array},initialItemDetails:{type:Object,default:()=>({id:-1,name:"",description:"",law:"",isLegal:!1,isPublished:!1,categoryId:-1,levelId:-1})}},data(){return{subHeaderRouterrouter:{path:"/admin/dashboard/newest"},toadd:{categoryId:"",name:"",levelId:"",isLegal:!1,description:"",law:"",isPublished:!1},isSuggestLevelsExist:!1,isLevelLoading:!1,isProcessing:!1,suggestLevels:[{id:0,level:0,category:""}],legalOptions:[{value:1,name:"是",checked:!0},{value:0,name:"否",checked:!1}]}},methods:{backdashboard(){this.$router.push("/admin/dashboard/newest")},async handleCategoryChange(e){const t=+e.target.value;try{if(!t)return;{this.isLevelLoading=!0;const e=await l["a"].getSuggestLevels({categoryId:t});this.suggestLevels=[...e.data.data.suggestLevels],this.isSuggestLevelsExist=!0,this.isLevelLoading=!1}}catch(a){console.error(a.response.data.message),d["a"].fire({icon:"error",title:a.response.data.message})}},async handleFormSave(e){try{this.isProcessing=!0,e.isPublished=!1;const t=await l["a"].addOption(e);if(201!==t.status)throw new Error(t.data.message);this.isProcessing=!1,d["a"].fire({icon:"success",title:t.data.status}),this.backdashboard()}catch(t){this.isProcessing=!1,console.error(t.response.data.message),d["a"].fire({icon:"error",title:t.response.data.message})}},async handleFormSubmit(e){try{this.isProcessing=!0,e.isPublished=!0;const t=await l["a"].addOption(e);if(201!==t.status)throw new Error(t.data.message);this.isProcessing=!1,d["a"].fire({icon:"success",title:t.data.status}),this.backdashboard()}catch(t){this.isProcessing=!1,console.error(t.response.data.message),d["a"].fire({icon:"error",title:t.response.data.message})}}}},u=c,p=(a("bd60"),a("2877")),v=Object(p["a"])(u,r,n,!1,null,"0e8ba477",null),g=v.exports,m=a("e362"),f={name:"CreateOption",components:{AdminHeader:o["a"],OptionForm:g},data(){return{categories:[]}},created(){this.fetchCategories()},methods:{async fetchCategories(){try{const e=await m["b"].getcategories();this.categories=e.data.data}catch(e){console.error(e.response.data.message),d["a"].fire({icon:"error",title:e.response.data.message})}}}},h=f,b=(a("632b"),Object(p["a"])(h,s,i,!1,null,"68dbb663",null));t["default"]=b.exports},"3bbf":function(e,t,a){},5407:function(e,t,a){"use strict";var s=function(){var e=this,t=e._self._c;return t("header",{staticClass:"site-header sticky-top py-1"},[t("nav",{staticClass:"container col-10 d-flex flex-column flex-md-row justify-content-between"},[e._m(0),t("p",{staticClass:"py-2 d-none d-md-inline-block"},[e._v("管理者，您好")]),t("div",{staticClass:"py-2 d-none d-md-inline-block",on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.logout.apply(null,arguments)}}},[e._v(" 登出 ")])])])},i=[function(){var e=this,t=e._self._c;return t("a",{staticClass:"py-2",attrs:{href:"#","aria-label":"Product"}},[t("img",{attrs:{src:a("6a5e"),alt:"logo"}})])}],o={name:"AdminHeader",methods:{logout(){this.$store.commit("revokeAuthentication"),this.$router.push("/admin/login")}}},r=o,n=(a("1f9e"),a("2877")),l=Object(n["a"])(r,s,i,!1,null,"07c191bc",null);t["a"]=l.exports},"632b":function(e,t,a){"use strict";a("78b9")},"6ba4":function(e,t,a){},"78b9":function(e,t,a){},bd60:function(e,t,a){"use strict";a("6ba4")}}]);
//# sourceMappingURL=chunk-9ca2a72e.7dddc624.js.map